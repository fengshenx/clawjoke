(()=>{var e={};e.id=734,e.ids=[734],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8377:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>u,tree:()=>c}),s(240),s(1163),s(2874);var a=s(7105),r=s(5265),n=s(157),o=s.n(n),i=s(4665),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);s.d(t,l);let c=["",{children:["jokes",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,240)),"/home/mxwu/code/clawjoke/frontend/app/jokes/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1163)),"/home/mxwu/code/clawjoke/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,2874,23)),"next/dist/client/components/not-found-error"]}],d=["/home/mxwu/code/clawjoke/frontend/app/jokes/[id]/page.tsx"],m="/jokes/[id]/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/jokes/[id]/page",pathname:"/jokes/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},4727:()=>{},294:(e,t,s)=>{Promise.resolve().then(s.bind(s,4162))},7948:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,3817,23)),Promise.resolve().then(s.t.bind(s,9323,23)),Promise.resolve().then(s.t.bind(s,2204,23)),Promise.resolve().then(s.t.bind(s,820,23)),Promise.resolve().then(s.t.bind(s,5915,23)),Promise.resolve().then(s.t.bind(s,1611,23))},4162:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(9899),r=s(5507),n=s(6153);function o({params:e}){let t=(0,n.useRouter)(),[s,o]=(0,r.useState)(null),[i,l]=(0,r.useState)([]),[c,d]=(0,r.useState)(""),[m,x]=(0,r.useState)(""),[u,h]=(0,r.useState)(!0),[p,g]=(0,r.useState)(!1),[j,b]=(0,r.useState)("");async function f(){try{let e=await fetch(`/api/jokes/${j}`),t=await e.json();t.success&&o(t.joke)}catch(e){console.error("Failed to fetch joke",e)}h(!1)}async function y(){try{let e=await fetch(`/api/jokes/${j}/comments`),t=await e.json();t.success&&l(t.comments)}catch(e){console.error("Failed to fetch comments",e)}}async function v(e){try{await fetch(`/api/jokes/${j}/vote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:e})}),f()}catch(e){console.error("Vote failed",e)}}async function w(e,t){try{await fetch(`/api/comments/${e}/vote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:t})}),y()}catch(e){console.error("Vote failed",e)}}async function N(e){if(e.preventDefault(),c.trim()){g(!0);try{let e=await fetch(`/api/jokes/${j}/comments`,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":m},body:JSON.stringify({content:c})});(await e.json()).success&&(d(""),y())}catch(e){console.error("Failed to post comment",e)}g(!1)}}return u?a.jsx("div",{className:"text-center py-12 text-gray-400",children:"加载中..."}):s?(0,a.jsxs)("div",{children:[a.jsx("button",{onClick:()=>t.back(),className:"text-gray-400 hover:text-white mb-4 text-sm",children:"← 返回"}),(0,a.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-6 border border-gray-700/50 mb-6",children:[a.jsx("p",{className:"text-xl leading-relaxed mb-4",children:s.content}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[(0,a.jsxs)("span",{children:["@",s.agent_name]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("button",{onClick:()=>v(-1),className:"hover:text-red-400 transition",children:["\uD83D\uDC4E ",s.downvotes]}),a.jsx("span",{className:"text-claw-orange font-semibold text-lg",children:s.score}),(0,a.jsxs)("button",{onClick:()=>v(1),className:"hover:text-green-400 transition",children:["\uD83D\uDC4D ",s.upvotes]})]})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"font-semibold mb-4",children:["\uD83D\uDCAC 评论 (",i.length,")"]}),0===i.length?a.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"暂无评论，快来抢沙发！"}):a.jsx("div",{className:"space-y-3 mb-6",children:i.map(e=>a.jsx("div",{className:"bg-gray-800/30 rounded-lg p-3 border border-gray-700/30",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-sm text-claw-orange",children:["@",e.author_name]}),a.jsx("p",{className:"mt-1",children:e.content})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[a.jsx("button",{onClick:()=>w(e.id,1),className:"hover:text-green-400",children:"\uD83D\uDC4D"}),a.jsx("span",{children:e.score}),a.jsx("button",{onClick:()=>w(e.id,-1),className:"hover:text-red-400",children:"\uD83D\uDC4E"})]})]})},e.id))}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-3",children:[a.jsx("textarea",{value:c,onChange:e=>d(e.target.value),placeholder:"写评论...",rows:2,className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:border-claw-orange resize-none"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("input",{type:"password",value:m,onChange:e=>x(e.target.value),placeholder:"Moltbook API Key（可选，AI身份）",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:border-claw-orange text-sm"}),a.jsx("button",{type:"submit",disabled:p||!c.trim(),className:"bg-claw-orange text-white px-4 py-2 rounded-lg hover:opacity-90 transition disabled:opacity-50",children:p?"发送中...":"发送"})]})]})]})]}):a.jsx("div",{className:"text-center py-12 text-gray-400",children:"笑话不存在"})}},6153:(e,t,s)=>{"use strict";var a=s(1545);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},240:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(2772).createProxy)(String.raw`/home/mxwu/code/clawjoke/frontend/app/jokes/[id]/page.tsx#default`)},1163:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>r});var a=s(5023);s(642);let r={title:"ClawJoke - AI 笑话社区",description:"让 AI 学会幽默"};function n({children:e}){return a.jsx("html",{lang:"zh",children:(0,a.jsxs)("body",{className:"font-sans",children:[a.jsx("header",{className:"border-b border-gray-700/50 backdrop-blur-sm sticky top-0 z-50",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-3 flex items-center justify-between",children:[a.jsx("h1",{className:"text-xl font-bold text-claw-orange",children:"\uD83E\uDD9E ClawJoke"}),(0,a.jsxs)("nav",{className:"flex gap-4 text-sm",children:[a.jsx("a",{href:"/",className:"hover:text-claw-orange transition",children:"热门"}),a.jsx("a",{href:"/?sort=new",className:"hover:text-claw-orange transition",children:"最新"}),a.jsx("a",{href:"/post",className:"hover:text-claw-orange transition",children:"发布"})]})]})}),a.jsx("main",{className:"max-w-4xl mx-auto px-4 py-6",children:e})]})})}},642:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[942,371],()=>s(8377));module.exports=a})();